# Detect Havoc beacon loaded into memory

## Author
Trellix

## Description
This rule detects and intiates a memory scan when any Process tries to read from Windows protected directories like C:\Windows and C:\Program Files.

## Rule Class 
Files

## Rule TCL
```tcl
Rule {
    Reaction SCAN ACTOR_PROCESS ScanAction REPORT_CLEAN_DELETE_PROCESS
    Process {
        Exclude VTP_PRIVILEGES -type BITMASK { -v 0x9 }
    }
   
    Target {
        Match FILE {
            Include OBJECT_NAME { -v "**.bin" }
            Exclude OBJECT_NAME { -v "**\\Windows\\**" }
            Exclude OBJECT_NAME { -v "**\\Program Files\\**" }
            Exclude OBJECT_NAME { -v "**\\Program Files (x86)\\**" }
            Include -access "READ"
        }
    }
}
```

## Notes
Customers are advised to fine-tune the rule in their environment or disable the signature if there are false positives / performance degradation.
This expert rule requires v3 DAT to be applied to the endpoints for expert rule to initiate memory scan.