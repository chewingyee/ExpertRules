# Detection on havoc payload injected into memory using Local PE inject tool.

## Author
Trellix

## Description
This rule detects and intiates a memory scan when any Process attempts to execute PE tool commands except from known Windows folders.
## Rule Class 
Process

## Rule TCL
```tcl
Rule {
                Reaction SCAN TARGET_PROCESS ScanAction REPORT_CLEAN_DELETE_PROCESS
                Target {
                        Match PROCESS {
                                Exclude OBJECT_NAME { -v "**\\Windows\\**" }
                                Exclude OBJECT_NAME { -v "**\\ProgramData\\**" }
                                Exclude OBJECT_NAME { -v "**\\Program Files\\**" }
                                Exclude OBJECT_NAME { -v "**\\Program Files (x86)\\**" }                                                  
                                Include OBJECT_NAME { -v "**.exe" }
                                Include PROCESS_CMD_LINE { -v "**-pe**" }
                                Include -access "CREATE"
                }
    }
}

```

## Tested Platforms
OS: Win 10 , ENS 10.7.0

## Notes
Customers are advised to fine-tune the rule in their environment or disable the signature if there are false positives observed.
